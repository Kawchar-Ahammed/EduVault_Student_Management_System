<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="controllers.FacultyController">
   <top>
      <VBox>
         <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: #1a237e; -fx-padding: 15;">
            <Label text="🛡️🎓" style="-fx-text-fill: #ffc107; -fx-font-size: 24px;" />
            <VBox>
               <Label text="EduVault Academic Management System" style="-fx-text-fill: white; -fx-font-size: 18px; -fx-font-weight: bold;" />
               <Label text="Faculty Dashboard - Securing Academic Success" style="-fx-text-fill: #ffc107; -fx-font-size: 12px;" />
            </VBox>
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="welcomeLabel" text="Welcome, Faculty" style="-fx-text-fill: white; -fx-font-size: 14px;" />
            <Button fx:id="logoutButton" text="Logout" onAction="#handleLogout" style="-fx-background-color: #e74c3c; -fx-text-fill: white;" />
         </HBox>
      </VBox>
   </top>
   
   <center>
      <TabPane fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE">
         
         <!-- Academic Session Selection -->
         <Tab text="Academic Session">
            <VBox spacing="20" alignment="CENTER">
               <padding>
                  <Insets top="50" right="50" bottom="50" left="50" />
               </padding>
               
               <Label text="Select Academic Session" style="-fx-font-size: 18px; -fx-font-weight: bold;" />
               
               <GridPane hgap="15" vgap="15" alignment="CENTER">
                  <columnConstraints>
                     <ColumnConstraints hgrow="SOMETIMES" minWidth="100" />
                     <ColumnConstraints hgrow="SOMETIMES" minWidth="200" />
                  </columnConstraints>
                  
                  <Label text="Session:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                  <ComboBox fx:id="sessionComboBox" promptText="Select Session" GridPane.columnIndex="1" GridPane.rowIndex="0" maxWidth="Infinity" />
                  
                  <Label text="Batch:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                  <ComboBox fx:id="batchComboBox" promptText="Select Batch" GridPane.columnIndex="1" GridPane.rowIndex="1" maxWidth="Infinity" />
                  
                  <Label text="Semester:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                  <ComboBox fx:id="semesterComboBox" promptText="Select Semester" GridPane.columnIndex="1" GridPane.rowIndex="2" maxWidth="Infinity" />
                  
                  <Label text="Course:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                  <ComboBox fx:id="courseComboBox" promptText="Select Course" GridPane.columnIndex="1" GridPane.rowIndex="3" maxWidth="Infinity" />
               </GridPane>
               
               <Label text="Note: Please select the academic session, batch, semester, and course before proceeding to Mark Entry or Attendance tabs." 
                     style="-fx-font-style: italic; -fx-text-fill: #7f8c8d;" wrapText="true" maxWidth="500" />
            </VBox>
         </Tab>
         
         <!-- Mark Entry Tab -->
         <Tab text="Mark Entry">
            <VBox spacing="15">
               <padding>
                  <Insets top="15" right="15" bottom="15" left="15" />
               </padding>
               
               <HBox spacing="15" alignment="CENTER_LEFT">
                  <Label text="Mark Entry" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                  <Region HBox.hgrow="ALWAYS" />
                  <Label text="Assessment Type:" />
                  <ComboBox fx:id="assessmentTypeComboBox" promptText="Select Type" />
                  <Button fx:id="viewStudentListButton" text="View List" onAction="#handleViewStudentList" 
                          style="-fx-background-color: #3498db; -fx-text-fill: white;" />
               </HBox>
               
               <TableView fx:id="markEntryTable" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="studentIdColumn" text="Student ID" prefWidth="120" />
                     <TableColumn fx:id="studentNameColumn" text="Student Name" prefWidth="200" />
                     <TableColumn fx:id="marksColumn" text="Marks" prefWidth="100" />
                     <TableColumn fx:id="absentColumn" text="Absent" prefWidth="80" />
                  </columns>
                  <placeholder>
                     <Label text="No students to display. Please select a course and click 'View List'." />
                  </placeholder>
               </TableView>
               
               <HBox alignment="CENTER_RIGHT" spacing="10">
                  <Button fx:id="submitMarksButton" text="Submit Marks" onAction="#handleSubmitMarks" 
                          style="-fx-background-color: #27ae60; -fx-text-fill: white;" disable="true" />
               </HBox>
            </VBox>
         </Tab>
         
         <!-- Attendance Tab -->
         <Tab text="Attendance">
            <VBox spacing="15">
               <padding>
                  <Insets top="15" right="15" bottom="15" left="15" />
               </padding>
               
               <HBox spacing="15" alignment="CENTER_LEFT">
                  <Label text="Attendance Entry" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                  <Region HBox.hgrow="ALWAYS" />
                  <Button fx:id="viewAttendanceListButton" text="View List" onAction="#handleViewStudentList" 
                          style="-fx-background-color: #3498db; -fx-text-fill: white;" />
               </HBox>
               
               <TableView fx:id="attendanceTable" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="attendanceStudentIdColumn" text="Student ID" prefWidth="120" />
                     <TableColumn fx:id="attendanceStudentNameColumn" text="Student Name" prefWidth="200" />
                     <TableColumn fx:id="attendanceStatusColumn" text="Status" prefWidth="150" />
                  </columns>
                  <placeholder>
                     <Label text="No students to display. Please select a course and click 'View List'." />
                  </placeholder>
               </TableView>
               
               <HBox alignment="CENTER_RIGHT" spacing="10">
                  <Button fx:id="submitAttendanceButton" text="Submit Attendance" onAction="#handleSubmitAttendance" 
                          style="-fx-background-color: #27ae60; -fx-text-fill: white;" disable="true" />
               </HBox>
            </VBox>
         </Tab>
         
         <!-- Send Marks Tab -->
         <Tab fx:id="sendMarksTab" text="Send Marks">
            <VBox spacing="15">
               <padding>
                  <Insets top="15" right="15" bottom="15" left="15" />
               </padding>
               
               <HBox spacing="15" alignment="CENTER_LEFT">
                  <Label text="Send Marks to Students" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                  <Region HBox.hgrow="ALWAYS" />
                  <Button fx:id="selectAllButton" text="Select All" 
                          style="-fx-background-color: #3498db; -fx-text-fill: white;" />
                  <Button fx:id="deselectAllButton" text="Deselect All" 
                          style="-fx-background-color: #95a5a6; -fx-text-fill: white;" />
               </HBox>
               
               <TableView fx:id="markSummaryTable" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="summaryStudentIdColumn" text="Student ID" prefWidth="120" />
                     <TableColumn fx:id="summaryStudentNameColumn" text="Student Name" prefWidth="200" />
                     <TableColumn fx:id="summaryEmailColumn" text="Email" prefWidth="200" />
                     <TableColumn fx:id="summaryMarksColumn" text="Marks" prefWidth="80" />
                     <TableColumn fx:id="sendEmailColumn" text="Send Email" prefWidth="100" />
                  </columns>
                  <placeholder>
                     <Label text="No marks to send. Please submit marks in the Mark Entry tab first." />
                  </placeholder>
               </TableView>
               
               <HBox alignment="CENTER_RIGHT" spacing="10">
                  <Button fx:id="sendMarksEmailButton" text="Send Emails" onAction="#handleSendMarksEmail" 
                          style="-fx-background-color: #9b59b6; -fx-text-fill: white;" />
               </HBox>
            </VBox>
         </Tab>
         
         <!-- Reports Tab -->
         <Tab text="Reports">
            <VBox spacing="20">
               <padding>
                  <Insets top="20" right="20" bottom="20" left="20" />
               </padding>
               
               <Label text="Course Reports &amp; Analytics" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
               
               <GridPane hgap="20" vgap="15">
                  <columnConstraints>
                     <ColumnConstraints hgrow="SOMETIMES" />
                     <ColumnConstraints hgrow="SOMETIMES" />
                     <ColumnConstraints hgrow="SOMETIMES" />
                  </columnConstraints>
                  
                  <!-- Statistics Cards -->
                  <VBox GridPane.columnIndex="0" GridPane.rowIndex="0" spacing="10" 
                        style="-fx-background-color: #ecf0f1; -fx-padding: 20; -fx-background-radius: 10;">
                     <Label text="Total Students" style="-fx-font-size: 14px; -fx-font-weight: bold;" />
                     <Label fx:id="totalStudentsLabel" text="0" style="-fx-font-size: 24px; -fx-text-fill: #2c3e50;" />
                  </VBox>
                  
                  <VBox GridPane.columnIndex="1" GridPane.rowIndex="0" spacing="10" 
                        style="-fx-background-color: #ecf0f1; -fx-padding: 20; -fx-background-radius: 10;">
                     <Label text="Average Attendance" style="-fx-font-size: 14px; -fx-font-weight: bold;" />
                     <Label fx:id="averageAttendanceLabel" text="0%" style="-fx-font-size: 24px; -fx-text-fill: #2c3e50;" />
                  </VBox>
                  
                  <VBox GridPane.columnIndex="2" GridPane.rowIndex="0" spacing="10" 
                        style="-fx-background-color: #ecf0f1; -fx-padding: 20; -fx-background-radius: 10;">
                     <Label text="Average Marks" style="-fx-font-size: 14px; -fx-font-weight: bold;" />
                     <Label fx:id="averageMarksLabel" text="0" style="-fx-font-size: 24px; -fx-text-fill: #2c3e50;" />
                  </VBox>
               </GridPane>
               
               <!-- Report Generation Section -->
               <Label text="Generate Reports" style="-fx-font-size: 14px; -fx-font-weight: bold;" />
               
               <HBox spacing="15">
                  <Button fx:id="generateAttendanceReportButton" text="Attendance Report" onAction="#handleGenerateAttendanceReport"
                          style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-pref-width: 150;" />
                  <Button fx:id="generateMarksReportButton" text="Marks Report" onAction="#handleGenerateMarksReport"
                          style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-pref-width: 150;" />
                  <Button fx:id="generateCourseReportButton" text="Course Report" onAction="#handleGenerateCourseReport"
                          style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-pref-width: 150;" />
               </HBox>
               
               <!-- Detailed Attendance Report Table -->
               <Label text="Detailed Attendance Report" style="-fx-font-size: 14px; -fx-font-weight: bold;" />
               
               <TableView fx:id="attendanceReportTable" VBox.vgrow="ALWAYS">
                  <columns>
                     <TableColumn fx:id="reportStudentIdColumn" text="Student ID" prefWidth="120" />
                     <TableColumn fx:id="reportStudentNameColumn" text="Student Name" prefWidth="200" />
                     <TableColumn fx:id="totalClassesColumn" text="Total Classes" prefWidth="100" />
                     <TableColumn fx:id="presentClassesColumn" text="Present" prefWidth="80" />
                     <TableColumn fx:id="absentClassesColumn" text="Absent" prefWidth="80" />
                     <TableColumn fx:id="attendancePercentColumn" text="Attendance %" prefWidth="120" />
                     <TableColumn fx:id="attendanceMarksColumn" text="Attendance Marks" prefWidth="150" />
                  </columns>
                  <placeholder>
                     <Label text="Click 'Attendance Report' to generate detailed attendance data." />
                  </placeholder>
               </TableView>
               
               <HBox alignment="CENTER_RIGHT" spacing="10">
                  <Button fx:id="exportAttendanceReportButton" text="Export to Excel" onAction="#handleExportAttendanceReport"
                          style="-fx-background-color: #27ae60; -fx-text-fill: white;" />
                  <Button fx:id="sendAttendanceEmailButton" text="Email to Students" onAction="#handleSendAttendanceEmail"
                          style="-fx-background-color: #3498db; -fx-text-fill: white;" />
               </HBox>
            </VBox>
         </Tab>
         
      </TabPane>
   </center>
   
   <bottom>
      <HBox alignment="CENTER" style="-fx-background-color: #1a237e; -fx-padding: 10;">
         <Label text="EduVault Academic Management System © 2025 - Securing Academic Success" style="-fx-text-fill: white; -fx-font-size: 12px;" />
      </HBox>
   </bottom>
</BorderPane>
